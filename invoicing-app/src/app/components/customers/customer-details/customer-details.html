<section class="page">
    @if (screenWidth() > 700) {
    <div class="customer-details-grid">
        <div class="item-container span-2">
            <span class="item-header">
                customer code:
            </span>
            <br>
            <span>
                {{customer?.customerCode}}
            </span>
        </div>
        <div class="item-container span-3">
            <span class="item-header">
                Name:
            </span>
            <br>
            <span>
                {{customer?.firstName || ""}} {{customer?.lastName}}
            </span>
        </div>
        <div class="item-container flex column justify-center align-center"
            style="grid-row: span 2; text-align: center;">
            <span class="item-header">
                Status:
            </span>
            <br>
            <mat-icon [style]="{'color':customer?.activeStatus ? 'green': 'red'}">
                {{customer?.activeStatus ? 'check_circle' : 'cancel'}}
            </mat-icon>
        </div>
        <div class="item-container span-2">
            <span class="item-header">
                Company Name:
            </span>
            <br>
            <span>
                enterprise inc
            </span>
        </div>
        <div class="item-container span-3">
            <span class="item-header">
                Email:
            </span>
            <br>
            <span>
                {{customer?.email}}
            </span>
        </div>
    </div>
    }@else {
    <div style="display: flex; flex-direction: column; gap:5px;">
        <div class="item-container" style="text-align: center;">
            <span class="item-header">
                customer code:
            </span>
            <br>
            <span>
                {{customer?.customerCode}}
            </span>
        </div>
        <div class="item-container" style="text-align: center;">
            <span class="item-header">
                Name:
            </span>
            <br>
            <span>
                {{customer?.firstName || ""}} {{customer?.lastName}}
            </span>
        </div>
        <div class="item-container span-2" style="text-align: center;">
            <span class="item-header">
                Company Name:
            </span>
            <br>
            <span>
                {{customer?.company}}
            </span>
        </div>
        <div class="item-container span-3" style="text-align: center;">
            <span class="item-header">
                Email:
            </span>
            <br>
            <span>
                {{customer?.email}}
            </span>
        </div>
        <div class="item-container" style="text-align: center;">
            <span class="item-header">
                Status:
            </span>
            <br>
            <mat-icon [style]="{'color':customer?.activeStatus ? 'green': 'red'}">
                {{customer?.activeStatus ? 'check_circle' : 'cancel'}}
            </mat-icon>
        </div>
    </div>
    }

    <div class="action-container">
        <div class="customer-btn-container">
            <button class="btn" style="width: 150px;" (click)="onNewInvoiceClick()">
                <span>
                    New Invoice
                </span>
            </button>
            <app-edit-customer [customerProp]="customer" (onCustomerEdit)="onCustomerEdit()"></app-edit-customer>
            <app-delete-customer [customerCode]="customer?.customerCode || ''"></app-delete-customer>
        </div>

    </div>

    <div class="container mat-elevation-z8">
        @if (isLoadingResults || isRateLimitReached) {
        <div class="loading-shade">
            @if (isLoadingResults) {
            <mat-spinner></mat-spinner>
            }
            @if (isRateLimitReached) {
            <div class="rate-limit-reached">
                API rate limit has been reached. It will be reset in one minute.
            </div>
            }
        </div>
        }

        <div class="table-container">
            <table mat-table [dataSource]="data" class="example-table" matSort matSortActive="customerCode"
                matSortDisableClear matSortDirection="desc">
                <ng-container matColumnDef="invoiceNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Invoice Number</th>
                    <td mat-cell *matCellDef="let row">{{row.invoiceReference}}</td>
                </ng-container>
                <ng-container matColumnDef="date">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Date</th>
                    <td mat-cell *matCellDef="let row">{{row.invoiceDate}}</td>
                </ng-container>
                <ng-container matColumnDef="subTotal">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Sub Total</th>
                    <td mat-cell *matCellDef="let row">{{row.subTotal}}</td>
                </ng-container>
                <ng-container matColumnDef="paid">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Paid</th>
                    <td mat-cell *matCellDef="let row">{{row.paid}}</td>
                </ng-container>
                <ng-container matColumnDef="gst">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>GST</th>
                    <td mat-cell *matCellDef="let row">{{row.gst}}</td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr class="customer-row" mat-row *matRowDef="let row; columns: displayedColumns;"
                    (click)="onInvoiceRowClick(row?.id)"></tr>
            </table>
        </div>

        <mat-paginator [length]="resultsLength" [pageSize]="30"
            aria-label="Select page of GitHub search results"></mat-paginator>
    </div>
</section>